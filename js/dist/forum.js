module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=15)}([function(e,t){e.exports=flarum.core.compat["forum/app"]},function(e,t){e.exports=flarum.core.compat["common/extend"]},function(e,t){e.exports=flarum.core.compat["flags/forum/components/FlagPostModal"]},function(e,t){e.exports=flarum.core.compat["forum/components/Post"]},function(e,t){e.exports=flarum.extensions["fof-merge-discussions"]},function(e,t){e.exports=flarum.core.compat["common/utils/withAttr"]},function(e,t){e.exports=flarum.core.compat["forum/states/GlobalSearchState"]},function(e,t){e.exports=flarum.core.compat["common/utils/Stream"]},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.isTraversal=void 0;var a=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,o=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,s=new Map([["~","element"],["^","start"],["$","end"],["*","any"],["!","not"],["|","hyphen"]]),i={">":"child","<":"parent","~":"sibling","+":"adjacent"},l={"#":["id","equals"],".":["class","element"]},c=new Set(["has","not","matches","is","where","host","host-context"]),u=new Set(r(["descendant"],Object.keys(i).map((function(e){return i[e]})),!0)),f=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function p(e){return u.has(e.type)}t.isTraversal=p;var d=new Set(["contains","icontains"]),m=new Set(['"',"'"]);function h(e,t,n){var r=parseInt(t,16)-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)}function v(e){return e.replace(o,h)}function g(e){return" "===e||"\n"===e||"\t"===e||"\f"===e||"\r"===e}function y(e,t){if(e.length>0&&0===t.length)throw new Error("Empty sub-selector");e.push(t)}t.default=function(e,t){var n=[],r=function e(t,n,r,o){var u,h;void 0===r&&(r={});var b=[],w=!1;function x(e){var t=n.slice(o+e).match(a);if(!t)throw new Error("Expected name, found "+n.slice(o));var r=t[0];return o+=e+r.length,v(r)}function A(e){for(;g(n.charAt(o+e));)e++;o+=e}function _(e){for(var t=0;"\\"===n.charAt(--e);)t++;return 1==(1&t)}function j(){if(b.length>0&&p(b[b.length-1]))throw new Error("Did not expect successive traversals.")}A(0);for(;""!==n;){var O=n.charAt(o);if(g(O))w=!0,A(1);else if(O in i)j(),b.push({type:i[O]}),w=!1,A(1);else if(","===O){if(0===b.length)throw new Error("Empty sub-selector");t.push(b),b=[],w=!1,A(1)}else if(n.startsWith("/*",o)){var S=n.indexOf("*/",o+2);if(S<0)throw new Error("Comment was not terminated");o=S+2}else if(w&&(j(),b.push({type:"descendant"}),w=!1),O in l){var C=l[O],P=C[0],M=C[1];b.push({type:"attribute",name:P,action:M,value:x(1),namespace:null,ignoreCase:!!r.xmlMode&&null})}else if("["===O){A(1);var k=null;"|"===n.charAt(o)&&(k="",o+=1),n.startsWith("*|",o)&&(k="*",o+=2);var E=x(0);null===k&&"|"===n.charAt(o)&&"="!==n.charAt(o+1)&&(k=E,E=x(1)),(null!==(u=r.lowerCaseAttributeNames)&&void 0!==u?u:!r.xmlMode)&&(E=E.toLowerCase()),A(0);M="exists";var D=s.get(n.charAt(o));if(D){if(M=D,"="!==n.charAt(o+1))throw new Error("Expected `=`");A(2)}else"="===n.charAt(o)&&(M="equals",A(1));var L="",N=null;if("exists"!==M){if(m.has(n.charAt(o))){for(var q=n.charAt(o),F=o+1;F<n.length&&(n.charAt(F)!==q||_(F));)F+=1;if(n.charAt(F)!==q)throw new Error("Attribute value didn't end");L=v(n.slice(o+1,F)),o=F+1}else{for(var W=o;o<n.length&&(!g(n.charAt(o))&&"]"!==n.charAt(o)||_(o));)o+=1;L=v(n.slice(W,o))}A(0);var T=n.charAt(o);"s"===T||"S"===T?(N=!1,A(1)):"i"!==T&&"I"!==T||(N=!0,A(1))}if(r.xmlMode||null!=N||(N=f.has(E)),"]"!==n.charAt(o))throw new Error("Attribute selector didn't terminate");o+=1;var B={type:"attribute",name:E,action:M,value:L,namespace:k,ignoreCase:N};b.push(B)}else if(":"===O){if(":"===n.charAt(o+1)){b.push({type:"pseudo-element",name:x(2).toLowerCase()});continue}var I=x(1).toLowerCase(),z=null;if("("===n.charAt(o))if(c.has(I)){if(m.has(n.charAt(o+1)))throw new Error("Pseudo-selector "+I+" cannot be quoted");if(o=e(z=[],n,r,o+1),")"!==n.charAt(o))throw new Error("Missing closing parenthesis in :"+I+" ("+n+")");o+=1}else{for(var R=o+=1,$=1;$>0&&o<n.length;o++)"("!==n.charAt(o)||_(o)?")"!==n.charAt(o)||_(o)||$--:$++;if($)throw new Error("Parenthesis not matched");if(z=n.slice(R,o-1),d.has(I)){var G=z.charAt(0);G===z.slice(-1)&&m.has(G)&&(z=z.slice(1,-1)),z=v(z)}}b.push({type:"pseudo",name:I,data:z})}else{k=null;var U=void 0;if("*"===O)o+=1,U="*";else{if(!a.test(n.slice(o)))return b.length&&"descendant"===b[b.length-1].type&&b.pop(),y(t,b),o;"|"===n.charAt(o)&&(k="",o+=1),U=x(0)}"|"===n.charAt(o)&&(k=U,"*"===n.charAt(o+1)?(U="*",o+=2):U=x(1)),"*"===U?b.push({type:"universal",namespace:k}):((null!==(h=r.lowerCaseTags)&&void 0!==h?h:!r.xmlMode)&&(U=U.toLowerCase()),b.push({type:"tag",name:U,namespace:k}))}}return y(t,b),o}(n,""+e,t,0);if(r<e.length)throw new Error("Unmatched selector: "+e.slice(r));return n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.stringify=t.parse=void 0,a(n(8),t);var s=n(8);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return o(s).default}});var i=n(14);Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return o(i).default}})},function(e,t){e.exports=flarum.core.compat["common/components/Link"]},function(e,t){e.exports=flarum.core.compat["common/helpers/icon"]},function(e,t){e.exports=flarum.core.compat["common/components/Button"]},function(e,t){e.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var a={equals:"",element:"~",start:"^",end:"$",any:"*",not:"!",hyphen:"|"},o=new Set(r(r([],Object.keys(a).map((function(e){return a[e]})).filter(Boolean),!0),[":","[","]"," ","\\","(",")","'"],!1));function s(e){return e.map(i).join(", ")}function i(e){return e.map(l).join("")}function l(e){switch(e.type){case"child":return" > ";case"parent":return" < ";case"sibling":return" ~ ";case"adjacent":return" + ";case"descendant":return" ";case"universal":return u(e.namespace)+"*";case"tag":return c(e);case"pseudo-element":return"::"+f(e.name);case"pseudo":return null===e.data?":"+f(e.name):"string"==typeof e.data?":"+f(e.name)+"("+f(e.data)+")":":"+f(e.name)+"("+s(e.data)+")";case"attribute":if("id"===e.name&&"equals"===e.action&&!e.ignoreCase&&!e.namespace)return"#"+f(e.value);if("class"===e.name&&"element"===e.action&&!e.ignoreCase&&!e.namespace)return"."+f(e.value);var t=c(e);return"exists"===e.action?"["+t+"]":"["+t+a[e.action]+"='"+f(e.value)+"'"+(e.ignoreCase?"i":!1===e.ignoreCase?"s":"")+"]"}}function c(e){return""+u(e.namespace)+f(e.name)}function u(e){return null!==e?("*"===e?"*":f(e))+"|":""}function f(e){return e.split("").map((function(e){return o.has(e)?"\\"+e:e})).join("")}t.default=s},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(1),s=n(2),i=n.n(s),l=n(9);function c(e,t,n){return function e(t,n,r){var a;a=Array.isArray(t)?t:[t];var o=void 0;a.some((function(t){if("boolean"==typeof t||"number"==typeof t||"string"==typeof t||null==t)return!1;if(Array.isArray(t)){var a=e(t,n,r);return!!a&&(o=a,!0)}if(function(e,t){return t.some((function(t){return t.every((function(t){var n,r,a,o;switch(t.type){case"tag":return e.tag===t.name;case"attribute":if(!e.attrs)return!1;"class"===t.name&&(t.name="className");var s=e.attrs[t.name];switch("className"===t.name&&"string"==typeof s&&(s=s.trim()),t.ignoreCase&&"string"==typeof s&&(s=s.toLowerCase(),t.value=t.value.toLowerCase()),t.action){case"exists":return e.attrs.hasOwnProperty(t.name);case"equals":return s===t.value;case"start":return(null==(n=s)||null==n.startsWith?void 0:n.startsWith(t.value))||!1;case"end":return(null==(r=s)||null==r.endsWith?void 0:r.endsWith(t.value))||!1;case"element":return(null==(a=s)||null==a.split||null==(o=a.split(" "))||null==o.includes?void 0:o.includes(t.value))||!1}}return!1}))}))}(t,n))return o=t,!0;if(Array.isArray(t.children)){var s=e(t.children,n);return!!s&&(o=s,!0)}return!1})),r&&o&&r(o);return o}(e,Object(l.parse)(t),n)}var u=n(5),f=n.n(u),p=n(3),d=n.n(p),h=n(10),v=n.n(h),g=n(11),y=n.n(g),b=n(4),w=n(6),x=n.n(w),A=n(12),_=n.n(A),j=n(7),O=n.n(j),S=n(13),C=n.n(S);a.a.initializers.add("blomstra/flag-duplicates",(function(){i.a.prototype.flagReasons||Object(o.extend)(i.a.prototype,"content",(function(e){var t,n=this;1===(null==(t=this.attrs.post)?void 0:t.number())&&c(e,".Form-group",(function(e){var t=n.attrs.post.discussion();n.search=new x.a,e.children[0].children.splice(0,0,m("label",{className:"checkbox"},m("input",{type:"radio",name:"reason",checked:"duplicate"===n.reason(),value:"duplicate",onclick:f()("value",n.reason)}),m("strong",null,a.a.translator.trans("blomstra-flag-duplicates.forum.flags.reason_duplicate_label")),a.a.translator.trans("blomstra-flag-duplicates.forum.flags.reason_duplicate_text"),"duplicate"===n.reason()?m(b.components.DiscussionSearch,{state:n.search,onSelect:function(e){n.reasonDetail=O()(e.id())}.bind(n),ignore:t.id()}):""))}))})),Object(o.extend)(i.a.prototype,"flagReasons",(function(e){var t,n=this;if(1===(null==(t=this.attrs.post)?void 0:t.number())){var r=this.attrs.post.discussion();this.search=new x.a,e.add("duplicate",m("label",{className:"checkbox"},m("input",{type:"radio",name:"reason",checked:"duplicate"===this.reason(),value:"duplicate",onclick:f()("value",this.reason)}),m("strong",null,a.a.translator.trans("blomstra-flag-duplicates.forum.flags.reason_duplicate_label")),a.a.translator.trans("blomstra-flag-duplicates.forum.flags.reason_duplicate_text"),"duplicate"===this.reason()?m(b.components.DiscussionSearch,{state:this.search,onSelect:function(e){n.reasonDetail=O()(e.id())}.bind(this),ignore:r.id()}):""),100)}})),Object(o.extend)(d.a.prototype,"flagActionItems",(function(e){var t,n=this;(null==(t=this.attrs.post)||null==t.flags?void 0:t.flags()).map((function(t){if("duplicate"===(null==t||null==t.reason?void 0:t.reason())){var r=n.attrs.post.discussion();e.remove("controls"),e.add("merge",m(_.a,{className:"Button",icon:"fas fa-code-branch fa-flip-vertical",disabled:!n.dupeDiscussion,onclick:function(){a.a.modal.show(b.components.DiscussionMergeModal,{discussion:r,preselect:n.dupeDiscussion})}},a.a.translator.trans("fof-merge-discussions.forum.discussion.merge")),5)}}))})),Object(o.override)(d.a.prototype,"flagReason",(function(e,t){var n=e(t);if("duplicate"===(null==t||null==t.reason?void 0:t.reason())){if(this.flagsLoading||!this.dupeDiscussion)return n[1]=m("span",{className:"Post-flagged-detail"},m(C.a,{size:"small",display:"inline"})),n;var r=a.a.route.discussion(this.dupeDiscussion);return n[1]=m("span",{className:"Post-flagged-detail"},m(v.a,{href:r,external:!0,target:"_blank"},this.dupeDiscussion.title()||a.a.translator.trans("blomstra-flag-duplicates.forum.flags.duplicate_discussion")," ",y()("fas fa-external-link-alt")," ")),n}return n})),Object(o.extend)(d.a.prototype,"oninit",(function(e){var t,n=this,r=null==(t=this.attrs.post)||null==t.flags?void 0:t.flags();r&&(this.flagsLoading=!0,r.map((function(e){"duplicate"===(null==e||null==e.reason?void 0:e.reason())&&a.a.store.find("discussions",e.reasonDetail()).then((function(e){n.dupeDiscussion=e}))})),this.flagsLoading=!1)}))}))}]);
//# sourceMappingURL=forum.js.map